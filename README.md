# Avellon - техническая часть ПО 

![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/logo.png)

### Содержание

1. [Запуск и установка](#run_install)
2. [Запуск и настройка вручную](#manual_run_install)
3. [Функционал](#functional)
4. [Работа с проектом](#project_work)
5. [Настройка скважины](#hole_settings)
6. [Конвертер](#converter)
7. [Осциллограмма](#oscilloscope_graph)
8. [Частотная характеристика](#frequency_graph)
9. [Роза ветров](#wind_rose_graph)
10. [Зависимость амплитуды во времени](#amplitude_graph)
11. [Глубинная характеристика](#depth_graph)


## Запуск и установка
<a name="run_install"></a>

Минимальная необходимая версия - `python 3.8`

![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/appbat.png)

Пока самые легкие установка и запуск проекта реализованы только для Windows.
Необходимо скачать данный проект, а после из "Проводника" запустить `app.bat`.
В первый раз установка может занять некоторое время. В последствии запускать
программу можно также через `app.bat`.

### Запуск и настройка вручную (через консоль)
<a name="manual_run_install"></a>

Необходимо скачать проект и открыть путь к нему в консоле
```bash
cd C:/Users/.../Avellon_tech
```
Установите виртуальное окружение Python
```bash
python3 -m venv venv
```
Чтобы войти в виртуальное окружение Python на Windows введите
```bash
venv\Scripts\activate.bat
```
На Unix системах (MacOS, Linux) 
(возможно перед этим придется сделать файл запуска 
виртуального окружения исполняемым через команду `chmod +x venv/bin/activate`)
```bash
./venv/bin/activate
```
После входа у вас перед путем текущей директории должна появиться
приписка `(venv)`

Установите все необходимые пакеты через pip из файла требуемых пакетов 
(Важно, выполняя этот шаг находиться в виртуальном окружении!)
```bash
pip install -r requirements.txt
```
После установки создайте следующие папки в директории проекта:
`projects`, `projects/test_1`, `save_data`, `data`.

Для запуска необходимо через Python запустить `main.py`, это делается следующей командой
```bash
python3 main.py
```
В следующие сессии работы с программой установка не требуется, 
а для запуска необходимо войти в виртуальное окружение и также запускать `main.py`.
То есть буквально ввести только следующие две команды:
```bash
./venv/bin/activate
python3 main.py
```

## Функционал
<a name="functional"></a>
В настоящий момент реализован следующий функционал:
* Создание проекта, как отдельной скважины 
* Добавление секций в скважину, их настройка (имя, глубина, длина) и удаление. Добавление шагов измерения в каждую секцию. Добавление файлов в каждый шаг.
* Построение Осциллограммы по выбранным файлам.
* Построение Частотный характеристики для всех датчиков во всех шагах
* Построение Розы ветров по датчикам
* Построение Графика зависимости амплитуды во времени
* Построение Графика глубинной характеристики по шагам
* Конвертер файлов

![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/main_menu.png)

Скачать тестовые данные можно по [ссылке](https://drive.google.com/file/d/1j_6-RZMyNiTh0wSIMSseCACk957Fua5j/view?usp=sharing).

Чтобы построить любой график, необходимо загрузить нужные файлы в окне настройки скважины, и нажать `▷ Построить` в окне желаемого графика. 
 
Каждый построенный график можно сохранить. Быстро с помощью пункта `Сохранить` в панеле сверху или сочетания клавиш `Ctrl+S`. 
Тогда файл автоматически сохраниться в папку `save_data` в директории проекта проекте.
Более детальное сохранение доступно при нажатии `Сохранить как` - `Ctrl+Shift+S`, тогда откроется диалоговое окно 
и появиться возможность выбрать место и имя сохраняемого файла.

В окне любого графика можно настроить скважину для всего проекта. Это делается через верхнюю панель `Настроить скважину`.

Для получения справочной информации необходимо нажать на `Справка` на верхней панеле.

При нажатии кнопки `Назад` на верхней панеле пользователь вернется в меню скважины.

У каждого графика можно убирать отдельные лини с помощью списка галочек.

### Работа с проектом
<a name="project_work"></a>

Впервые запуская программу пользователь попадет в необходимо создать проект. Это делается соответствующей кнопкой 
в соответствующем окне, где необходимо назвать проект и выбрать его месторасположение на компьютере. 

![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/how_project.png)

В последующие разы, программа будет открывать последний открытый проект. Для того чтобы из главного меню попасть в последний проект, 
есть соответствующая кнопка.

Для того чтобы открыть проект, нужно выбрать соответствующую папку (там необходим быть файл - `info.txt`).

Открыв проект, пользователь попадает в меню скважины, где уже может детальнее ее настраивать, строить графики и т.п.

![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/hole_menu.png)

В окне каждого графика, есть возможность посмотреть справку о чем бы, то ни было, связанным с программой.

![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/help.png)


### Настройка скважины
<a name="hole_settings"></a>

Настройка скважины есть единое окружение для постройки любого графика.
Для постройки некоторых из них необходимо определенное количество исходных файлов с данными.

![img.png](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/hole_settings.png)

При открытии экрана настройки скважины изначально будут доступны 3 кнопки:
* `+ Добавить секцию` - при нажатии которой в списке появляется секция с возможностью ее дальнейшего редактирования.
* `Принять` - все внесенные изменения в настройку секции вступят в силу
* `Отмена` - все внесенные изменения в настройку секции отменяться, скважина вернется в настройку до открытия окна настройки скважины

В соответствующий полях секции можно настроить `Имя` секции, `Глубину` ее месторасположения, `Длину`.
С помощью кнопок `+`, `▽`, `Х` можно добавить новый шаг в секцию,
открыть/закрыть список уже существующих шагов, полностью удалить секцию соответственно. У каждой секции должно быть свое уникальное имя 
(Написать два одинаковых, программа вам не позволит)

Аналогично у шага можно редактировать его номер, добавлять файлы с данными, открывать/закрывать список добавленных файлов,
удалять шаг. Номер уникален для каждого шага. Добавленные файлы должны иметь разное базовое название по формату `DEFAULT_A_0mm_0.csv`,
В противном случае в проекте останется только последний добавленный файл с повторяющимся именем.

Файлы также можно удалять с помощью кнопки `Х`. 

Пока что изменение имени или номера шага соответственно для Секции или Шага сотрет все что есть внутри них.

Галочки у каждого раздела означает, необходимо ли учитывать файл в построении осциллограммы.


## Конвертер файлов
<a name="converter"></a>
![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/converter.png)

Конвертер помогает быстро и просто переделывать файлы (поврежденные или имеющие лишние колонки данных) под формат тех,
что требует основная программа.

Первые три поля помогают настроить название файлов полученных при конвертировании, чтобы те соответствовали стандартам - DEFAULT_A_0mm_0.csv

Первое поле отвечает за настройку номера датчика, к которому относятся конвертируемые файлы. Оно может принимать значения от A(0) до H(7).

Второе поле ответственно за глубину трещины, отображаемой в названии - неотрицательное целое число.

Третье поле отвечает за то, начиная с какого номера будут отсчитываться номера измерений - неотрицательное целое число.

В конвертере можно выбрать, как отдельные файлы для последующего конвертирования, так и целые папки с файлами, или даже папки с папками. 


### Осциллограмма
<a name="oscilloscope_graph"></a>
![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/oscilloscope.png)

Если в скважину добавлены файлы, то с помощью кнопки в верхней панеле
можно построить осциллограмму выбранных файлов (поставлена галочка напротив).
Также автоматически строиться Таблица максимумов.

### Частотная характеристика
<a name="frequncy_graph"></a>
Для построения частотной характеристики для одного датчика необходимо хотя бы 2 файла в одном шаге.

![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/frequency.png)

Также в окне доступна возможность настройки визуализации участка скважины с трещинами.
Настройка производиться в окне вызываемом через `Инструменты->Задать параметры трубы`. 

![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/how_crack_menu.png)

В данном окне есть возможность настроить в соответствующих полях `Длину`, `Диаметр внутренности`, `Толщину стенок`,
`Направление прозвучки`, `Имена датчиков`. А также добавить трещины - `+ Добавить`. `Принять` - все внесенные изменения в настройку секции вступят в силу.
`Отмена` - все внесенные изменения в настройку секция отменяться, все вернется в настройку до открытия окна.

![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/crack_menu.png)

У каждой трещины можно настроить `Cторону` ее расположения - Верхняя/Нижняя, `Глубину` трещины, `Позицию` на трубе.


### Роза ветров
<a name="wind_rose_graph"></a>
![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/windrose.png)

Роза ветров строиться по датчикам секции по номерам измерений для абсолютных значений или для относительных.
Чтобы выбрать способ отображение есть галочка `Инструменты->Абсолютное значение`.
С помощью слайдера можно выбирать номер измерения для отображения соответствующей розы. 


### График зависимости амплитуды во времени
<a name="amplitude_graph"></a>
![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/amplitude.png)

График строиться по шагам для каждой секции. При этом можно отобразить, как конкретно датчики одной секции, 
так и отдельные датчики для всех секций. Также можно строить усредненные по всем датчикам шага одной секции. 
Способ среднего определяется, а так же режим отображения, выбирается в настройках. 
Помимо перечисленного, можно настроить график на отображение относительных величин.

![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/how_amplitude.png)


### Глубинная характеристика
<a name="depth_graph"></a>
![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/depth.png)

График строиться по шагам для каждой секции. При этом можно отобразить, как конкретно датчики одной секции, 
так и отдельные датчики для всех секций. Также можно строить усредненные по всем датчикам шага одной секции. 
Способ среднего определяется, а так же режим отображения, выбирается в настройках. 
Помимо перечисленного, можно настроить график на отображение относительных величин.

![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/how_depth.png)
